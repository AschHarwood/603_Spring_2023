---
title: "Estimating National Food Waste with State/Local Waste Characterization Studies in the United States"
author: "Asch Harwood"
description: "Final Project Part 1: Proposal"
date: "03/20/23"
format:
  html:
    toc: true
    code-fold: true
    code-copy: true
    code-tools: true
categories:
  - finalpart1
editor: 
  markdown: 
    wrap: 72
---

```{r message= FALSE}
library("dplyr")
library("knitr")
library(kableExtra)
library(xtable)
library(ggplot2)
library(GGally)
library(lme4)
library(car)
library(dplyr)
library(tidyverse)
```

# Background

ReFED, a national nonprofit that advocates for the reduction of food
waste, maintains several models to estimate the amount of wasted food
and its greenhouse gas emissions in the United States. Collectively,
U.S. residents and businesses throw out roughly 90 million tons of food
annually, contributing nearly 5 percent of the total net US greenhouse
gas emissions.

Creating system-level estimates in the food supply chain is notoriously
difficult. To produce these estimates, ReFED employs a 'mass balance'
accounting approach. For each sector, ReFED estimates the value of the
total supply of food in US dollars. It then applies a price per lb
conversion factor to convert dollars to tons to estimate the total suppy
of food in weight. ReFED then draws on academic and private-sector
studies to determine 'surplus rates'--the share of food that is not
going to its intended destination. The supply of food is multiplied by
these surplus rates to determine the total amount of surplus food in a
given place and year.

A limitation of this approach, however, is that the research to estimate
surplus rates is rarely, if ever, repeated at regular intervals. As a
result, the lack of year-over-year and geographic variation in surplus
rates makes it incredibly difficult to identify systematic changes in
the food waste behaviors.

# Proposal

My goal is to develop a cost-effective and maintainable model to estimate per capita food waste in the United States in a given year. I hypothesize that per capita food waste is a function of the current supply of available food combined with corporate and consumer knowledge, attitude, and beliefs about climate change. I believe food supply is an important explanatory variable for two reasons: 1)food waste is always a share of food supply and there is always a minimum amount of food needed to feed the population, and 2)it is standard at food business to have on hand more food than meets demand, which means that supply frequent outstrips demand, leading to food waste. However, I also believe that conern about climate-related issues is an important predictor. In particular, I hypothesize that greater concern for climate-related issues correlates with reduced food waste when controlling for issue like population. The logic is that if folks are more concerned with climate-issues, then they are more likely to try and 'right-size' the amount of food that is produced on the supply chain side and purchased on the consumer side.  

To test this hypothesis, we need a ground truth of food waste. The best publicly available direct measurement of food waste tends to be waste characterization studies. State and local governments periodically conduct inferential waste
characterization studies, where they randomly select typically a series of 200 - 300
lb samples from landfills and other waste management facilities across several seasons in a year, and
separate the garbage to determine the weight and composition of municipal solid
waste in a particular area over a predetermined time. These studies are
then used to set waste management budgets, 'right-size' landfill
capacity, and create/evaluate programs meant to divert recyclable and
compostable materials from landfills. These studies are some of the best sources 'direct measurement


However, they are not conducted
regularly or consistently (or at all in many places), and, to my
knowledge, there are no nationally-representative waste characterization
studies. The dominant approach, employed by the Environment Protection Agency and the United States Department of Agriculture use these studies to produce national food waste estimates. But they approach is to simply take just a handful of these publicly available studies, calculate a per capita estimate for the study, and then scale that number by the current calendar year population size. 

Nevertheless, I believe there is the potential to creatively use these
studies to estimate the share of food waste in landfills at the
national-level over time, and, hopefully, to determine if there are any
systematic changes in food waste management behavior in the commercial
and residential sectors.

### Research Questions

1.  How much food is currently wasted on a per capita basis in the United States?

2.  What factors explain differences in waste between states and over time?

4.  How do food waste estimates produced using a bottom-up method
    proposed here compare to top-down, mass balanced-based approaches?

### Independent/Dependent Variables

**Food Supply**

- As a proxy for food supply, which is quite difficult to measure, I'm utilizing supermarket revenue data by state from the years 2005 - 2021, which I extracted from Ibisworld State Industry reports. I then converted this measure to a state per capita basis. Note that in order to cover the missing years from 2000 - 2005, I fit a linear regression based on state, population, and year. However, this is meant to be a placeholder for the sack of this exercise. In future iterations, I plan to use data from 2005 to present.

**Consumer Knowledge**

- As a proxy for consumer knowledge, I extracted state-level search volume for the topic, "Climate Change", using Google Trends Supercharged, which provides absolute search volumne from 2004 to present. I then converted this measure to a state per capita basis. To fill missing years 2000 - 2003, I also fit a linear regression to serve as placeholder. Again, for future iterations, I plan to use a baseline of 2005.

**Corporate Knowledge**

- As a proxy for corporate knowledge/concern about climate changed, I extracted state-level search volume for the topic, "Sustainability", using Google Trends Supercharged. I then converted this measure to a state per capita basis. To fill missing years 2000 - 2003, I also fit a linear regression to serve as placeholder. Again, for future iterations, I plan to use a baseline of 2005.

**Consumer Corporate Knowledge Interaction**

- I included an interaction term between sustainability and climate change search volume. My argument for doing so is that they are meant to represent the 'supply' and 'demand', which hypothetically influence each other. While the sustainabilty search was the only statistically significant of the two search variables, adding the interaction term increased the overall R-squared as well as the adjusted r-squared.

**Food Waste**

- For the dependant variable, food waste per capita, I extracted absolute food waste weights from 20 state-level municipal solid waste characterization studies as well as the sample sizes collected to produce each of those calculations. I then calculated food waste per captia. Give the small size of this dataset, I mutiplied the sample size for each observation by the population in the respective state, which I then used as weights in the model.

### Control Variables

**Year**
- I wanted to control for the impact of change over time because estimates from other models (i.e. ReFED) show a general increase in food waste over time.

**Population**

- I control for population in two different ways - using per capita measures and including population as a control variable. Per capita metrics do not fully capture the influence of population, which hypotehtically should correlate with changes in food waste. Controlling for population increased the coefficients for my two statisitcally significant explanaotry variables as well as the multiple and adjusted r-squared.

### Hypothesis

**Food Supply**

H0: Supermarket revenue is not correlated with per capita food waste

H1: Increased supermarket revenue is correlated with increased per capita food waste

**Consumer Knowledge**

H0: Google search volume about 'climate change' is not correlated with per capita food waste

H1: Google search volume about 'climate change' is negatively correlated with per capita food waste

**Corporate Knowledge**

H0: Google search volume about 'sustainability' is not correlated
with per capita food waste

H1: Google search volume about 'sustainability' is negatively correlated with per capita
food waste


### Exploratory Data Analysis

Currently, no comprehensive aggregate municipal solid waste
characterization datasets exisit for the United States in the public
domain. To address this, I have compiled roughly 300 waste
characterization studies, of which I have parsed and coded roughly 50 to
date, based on the following (rough) criteria[^1]. To be eligible to be
included in my dataset, each study must be:

[^1]: I recognize that we were encouraged to work with pre-existing
    datasets. Nevertheless, I view this as an opportunity to prototype a
    project I believe might have real-world applicability in my
    professional life.

-   conducted in the United States and be representative of the state,
    county, or local level between the years of 2000 and 2021
-   infer the amount of total food as a share of the total amount of
    municipal solid waste for an entire year
-   report the number of samples, which need to be between 200 - 300 lbs
    each

```{r}
waste = read.csv('/Users/aschharwood/Desktop/intro_quant_spring_2023/quant_project_research_analysis/quant_project_env/data/x_y_state/x_y_state_waste.csv')

#create lists to filter waste to x, y and controls
y_col <- "total_food_per_capita"
x_cols <- c("gt_abs_sustain_per_capita","gt_abs_cc_per_capita" )
control_cols <- c('year',"state","sample_size","ibis_grcy_revenue_usd_m_per_capita_state","population")
drop_cols <- c('total_food',"total_waste_weight_per_capita","gt_norm_cc", "ibis_grcy_revenue_usd_m_state","gt_norm_sustain", "gt_norm_cc_per_capita", "total_waste_weight","gt_abs_sustain", "gt_abs_cc", "sample_size_per_capita", "coincident_index")
x_y_cols <- append(x_cols, y_col)
x_y_control_cols <- c(x_y_cols, control_cols)


#filter dataset
x_y_controls_df <- subset(waste, select = x_y_control_cols )

# Reorder columns
desired_order <- c("state", "year", "total_food_per_capita", "gt_abs_sustain_per_capita", "gt_abs_cc_per_capita", "ibis_grcy_revenue_usd_m_per_capita_state", "sample_size", "population")
x_y_controls_df <- x_y_controls_df[, desired_order]
str(x_y_controls_df)
```
```{r}
# Create a data frame with the data dictionary
data_dictionary <- data.frame(
  `col_name` = c("state", "year", "total_food_per_capita", "gt_abs_sustain_per_capita", "gt_abs_cc_per_capita", "ibis_grcy_revenue_usd_m_per_capita_state", "sample_size", "population"),
  `d_type` = c("chr", "int", "dbl", "dbl", "dbl", "dbl", "num", "int"),
  description = c(
    "U.S. state where the study was conducted",
    "Year when the study was conducted",
    "Total food per capita in the studied area",
    "Per capita absolute Google search volume for sustainability",
    "Per capita absolute Google search volume for climate change",
    "Per capita supermarket revenue (in USD million) for the state",
    "Number of samples from original waste characterization study",
    "Population of the studied area"
  )
)
kable(data_dictionary)
```

```{r}
ggplot(data = x_y_controls_df, aes(x=log(total_food_per_capita))) +
  geom_histogram(bins=10)
```
```{r}

# Reshape the data to long format without the year variable
long_data <- x_y_controls_df %>%
  select(total_food_per_capita, ibis_grcy_revenue_usd_m_per_capita_state, gt_abs_sustain_per_capita, gt_abs_cc_per_capita) %>%
  gather(key = "variable", value = "value")

# Create box and whisker plot for multiple variables without year
ggplot(data = long_data, aes(x = variable, y = value, fill = variable)) +
  geom_boxplot() +
  ggtitle("Box and Whisker Plot for X and Y Variables") +
  xlab("Variable") +
  ylab("Value") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 14)) +
  scale_fill_discrete(name = "Variable", labels = c("Total Food Per Capita", "Revenue Per Capita", "Sustainability Per Capita", "CC Per Capita")) +
  theme(legend.position = "none") +
  scale_x_discrete(labels = c("Total Food Per Capita", "Revenue Per Capita", "Sustainability Per Capita", "CC Per Capita"))
```



```{r}
ggplot(data = x_y_controls_df, aes(x=log(gt_abs_sustain_per_capita), y=log(total_food_per_capita))) +
  geom_point() +
  ggtitle("Sustainability Search Volume vs. Total Food Per Capita") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 14))
```

```{r}
ggplot(data = x_y_controls_df, aes(x=log(gt_abs_cc_per_capita), y=log(total_food_per_capita))) +
  geom_point() +
  ggtitle("Climate Change Search Volume vs. Total Food Per Capita") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 14))
```

```{r}
ggplot(data = x_y_controls_df, aes(x=log(ibis_grcy_revenue_usd_m_per_capita_state), y=log(total_food_per_capita))) +
  geom_point() +
  ggtitle("Grocery Revenue Per Capita vs. Total Food Per Capita") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 14))
```





