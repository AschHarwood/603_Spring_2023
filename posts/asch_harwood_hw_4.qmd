---
title: "Homework 4"
author: "Asch Harwood"
description: "Homework 4, Intro to Quant"
date: "4/25/2023"
format:
  html:
    toc: true
    code-fold: true
    code-copy: true
    code-tools: true
categories:
  - hw4
---

```{r}
library("dplyr")
library("knitr")
library(kableExtra)
library(xtable)
library(ggplot2)
library(GGally)
library(lme4)
library(car)
library(dplyr)
library(alr4)
library(stargazer)
```

# Question 1

For recent data in Jacksonville, Florida, on - y = selling price of home (in dollars)

-   x1 = size of home(in square feet)

-   x2 = lot size (in square feet),

-   prediction equation \<- ŷ = −10,536 + 53.8x1 + 2.84x2.

### A

A particular home of 1240 square feet on a lot of 18,000 square feet sold for \$145,000. Find the predicted selling price and the residual, and interpret.

```{r}
x1 <-  1240 #house size
x2 <- 18000 #lot size
y_observed <- 145000
```

```{r}
# find predicted selling price
y_hat <- (-10536) + (53.8*x1) + (2.84*x2)
residual <- y_observed - y_hat
cat('Predict sale price: $',  y_hat)
cat('\n')
cat('Residual: $', residual)
cat('\n')

cat('The predicted sale price of', y_hat, 'dollars is', residual, 'dollars less than the actual observed house price of', y_observed, '.')
```

### B

Holding the lot size fixed, each unit increase in square footage increases the house value by 53.8 dollars. This is because the square footage coefficient is 53.8. 

###C

The lot size would need to increase by 19.94 square feet to increase the home value by 53.8 dollars.

# Question 2

(Data file: salary in alr4 R package). The data file concerns salary and other characteristics of all
faculty in a small Midwestern college collected in the early 1980s for presentation in legal
proceedings for which discrimination against women in salary was at issue. All persons in the data
hold tenured or tenure track positions; temporary faculty are not included. The variables include
degree, a factor with levels PhD and MS; rank, a factor with levels Asst, Assoc, and Prof; sex, a
factor with levels Male and Female; Year, years in current rank; ysdeg, years since highest degree,
and salary, academic year salary in dollars.

```{r}
data(salary)
salary
```


### A 

We cannot reject the null hypothesis that there is a difference between the mean male and female salary at the 0.05 significance level given the observed p-value of 0.09. The 95 percent confidence interval supports because it contains zero. 

```{r}
ggplot(data = salary, aes(x=salary, fill=sex)) + 
  geom_histogram(bins=5)
```

```{r}
male_salaries <- salary[salary$sex == "Male",]$salary
female_salaries <- salary[salary$sex == "Female",]$salary
t.test(male_salaries, female_salaries)
```


### B 

```{r}
data(salary)
fit <- lm(salary ~ rank + sex + year + ysdeg + degree, data = salary)
sex_ci <- confint(fit)["sexFemale", ]
cat('sexFemale confidence interval: ', sex_ci)
```


### C

Intercept: The intercept of $15746.05 is when all over coefficients are zero, which can be interpreted as the 'base' salary. In this case, our base reference is a male, assistant professor with zero years of experience and 0 years since graduation

rankAssoc: Holding all else equal, associate professors make $5292.36 more than assistant professors. This finding is statistically significant, which means we can reject the null hypthosis that there is no different in salary between associate and assistant professors.

rankProf:  Holding all else equal, professors make $11118.76 more than assistant professors. This finding is statistically significant, which means we can reject the null hypthosis that there is no different in salary between professors and assistant professors.

sexFemale: Holding all else equal, female professors make $1166.37 more than male professors. This finding is NOT statistically significant, which means we cannot reject the null hypothesis that there is no difference in salary between male and female professors.

year: Holding all else equal, for each year increase in years in current position, salary increases by $476.31 This finding is statistically significant, which means we can reject the null hypothesis that an increase in years does not increase salary.

ysdeg: Holding all else equal, for each year increase in years since degree, salary decreases by $124.57. This finding is NOT statistically significant, which means we cannot reject the null hypothesis that a change in years in position does not have a corresponding change in salary.

degreePhD: Holding all else equal, professors with PhD's make $1388 more than those with masters degrees. This is NOT statistically significant.

```{r}
summary(fit)
```
###D 

rankAsst: Holding all else equal, associate professors make $10,162 less than a professor. This finding is statistically significant.

rankAssoc: Holding all else equal, assistant professors make $5,144 less than a professor.

```{r}
salary$rank <- relevel(salary$rank, ref="Prof")
fit <- lm(salary ~ rank + sex + year + ysdeg, data = salary)
summary(fit)
```
###E 

By excluding rank:

- the model as a whole is considerably less 'useful'. The r-squared has gone down from 85 to 56, as has the adjusted R-squared, even though we have simplified the model. This means the model without rank has less 'explainatory' power. We also see an increase in the residual standard error.

- sexFemale in the new model is now correlated with a decreased salary of $746 compared to the original models increase of $845. That being said, sex is still not statistically significant.

- there is a slight increase in the coefficient for year.

- Most notably, in the new model, an increase in one year in number of years since degree is associated with a $230 increase in salary, compared to $55 reduction from the previous model. This finding is statistically significant.

```{r}
fit_no_rank <- lm(salary ~ sex + year + ysdeg, data = salary)
```

```{r message=FALSE, warning=FALSE}
# Create a side-by-side table of the models using stargazer
stargazer(fit, fit_no_rank,type = "text",
          title = "Professor Salary Regression",
          align = TRUE,
          column.labels = c("M1:AllVari", "M2:NoRank"),
          ci = TRUE, # Show confidence intervals
          digits = 2) 
```

### F 

Everyone in this dataset was hired the year they earned their highest degree. It is also
known that a new Dean was appointed 15 years ago, and everyone in the dataset who
earned their highest degree 15 years ago or less than that has been hired by the new Dean.
Some people have argued that the new Dean has been making offers that are a lot more
generous to newly hired faculty than the previous one and that this might explain some of
the variation in Salary.

Create a new variable that would allow you to test this hypothesis and run another multiple
regression model to test this. Select variables carefully to make sure there is no
multicollinearity. Explain why multicollinearity would be a concern in this case and how
you avoided it. Do you find support for the hypothesis that the people hired by the new
Dean are making higher than those that were not?

```{r message=FALSE}
#add dean selection
salary$dean_selected <- ifelse(salary$ysdeg<=15, 1, 0)

#dropping ysdeg b/c correlated with dean_selected
x_no_y <- subset(salary, select = -c(salary, ysdeg))
pairs(x_no_y)

```
```{r}
salary
fit_dean <- lm(salary ~ )
```


# Question 3
(Data file: house.selling.price in smss R package)

### A 

Using the house.selling.price data, run and report regression results modeling y = selling
price (in dollars) in terms of size of home (in square feet) and whether the home is new (1 =
yes; 0 = no). In particular, for each variable; discuss statistical significance and interpret the
meaning of the coefficient.

### B

Report and interpret the prediction equation, and form separate equations relating selling
price to size for new and for not new homes.

### C

Find the predicted selling price for a home of 3000 square feet that is (i) new, (ii) not new.

### D 

Fit another model, this time with an interaction term allowing interaction between size and
new, and report the regression results

### E 

Report the lines relating the predicted selling price to the size for homes that are (i) new,
(ii) not new.

### F 

Find the predicted selling price for a home of 3000 square feet that is (i) new, (ii) not new.

###G 

Find the predicted selling price for a home of 1500 square feet that is (i) new, (ii) not new.
Comparing to (F), explain how the difference in predicted selling prices changes as the size
of home increases.

### H 

Do you think the model with interaction or the one without it represents the relationship of
size and new to the outcome price? What makes you prefer one model over another?


